{% extends "index.html" %} {% block content %}


<div class="tab-content" id="accountsummary">
    <div class="flex">
        <div class="trade-download">
            <div style="transform: rotate(90deg);padding-left: 10px; cursor:pointer;">
                <p id="accountFilterId">Filter</p>
            </div>
            <span>
                <a href="{% url 'Admin:account-summary-csv' id %}"><i class="fa-solid fa-file-csv"></i></a>
            </span>
        </div>
        <div class="trades-side">
            <div class="trade-top">
                <div class="flex space-bw">
                    <div>
                        <p>Filter</p>
                    </div>
                    <div class="closeBtn">
                        <i class="fa-solid fa-xmark"></i>
                    </div>
                </div>
            </div>
            <form method="get">
                {% csrf_token %}
                <div class="trade-btm">
                    <div>
                        <label for="">From:</label>
                        <input type="date" name="from_date" id="">
                    </div>
                    <div>
                        <label for="">To:</label>
                        <input type="date" name="to_date" id="">
                    </div>
                    <div>
                        <label for="">Username:</label>
                        <select name="" id="">
                            <option value="">{{request.user.user_name}}</option>
                        </select>
                    </div>
                    <div class="flex">
                        <div class="mr flex">
                            <p style="font-size: 14px; margin-right: 5px;">P/L</p>
                            <input type="checkbox" name="p_and_l" id="" class="unset mb-0">
                        </div>
                        <div class="mr flex">
                            <p style="font-size: 14px; margin-right: 5px;">Brk</p>
                            <input type="checkbox" name="brk" id="" class="unset mb-0">
                        </div>
                        <div class="mr flex">
                            <p style="font-size: 14px; margin-right: 5px;">Credit</p>
                            <input type="checkbox" name="credit" id="" class="unset mb-0">
                        </div>
                    </div>
                    <div>
                        <label for=""></label>
                        <button type="submit" value="View" class="form-btn">View</button>
                        <a style="color: #fff !important; padding: 2px;" href="{% url 'Admin:account-summary' %}" class="cancel-btn">Clear</a>
                    </div>
                </div>
            </form>
        </div>
        <div class="trades-body user-table" style="margin-top:1%;">
            {% comment %} <button class="delete-btn">Delete</button> {% endcomment %}
            {% if account_summary %}
            <table style="width: 100%;">
                <tr>
                    <th>Date</th>
                    <th>Username</th>
                    <th>Particular</th>
                    <th>Qty</th>
                    <th>Buy/Sell</th>
                    <th>Price</th>
                    <th>Average Price</th>
                    <th>Type</th>
                    <th>Amount</th>
                    <th>Closing</th>
                    <th>Open Qty</th>
                </tr>
                {% for i in account_summary %}
                <tr>
                    <td>{{i.created_at}}</td>
                    <td>{{i.user_summary__user_name}}</td>
                    <td>{{i.particular}}</td>
                    <td>{{i.quantity}}</td>
                    {% if i.buy_sell_type == "BUY" %}
                    <td style="color: blue;">{{i.buy_sell_type}}</td>
                    {% else %}
                    <td style="color: red;">{{i.buy_sell_type}}</td>
                    {% endif %}
                    <td>{{i.price}}</td>
                    <td>{{i.average|floatformat:2}}</td>
                    <td>{{i.summary_flg}}</td>
                    {% if i.amount > 0 %}
                        <td style="color: blue;">{{i.amount|floatformat:2}}</td>
                    {% else %}
                        <td style="color: red;">{{i.amount|floatformat:2}}</td>
                    {% endif %}
                    <td>{{i.closing}}</td>
                    <td>{{i.open_qty}}</td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
            <div style="display: flex;justify-content: center;margin-top: 14%;">
              <p>No data found</p>
            </div>
        {% endif %}
        </div>
    </div>
</div>

<script>
    $('.closeBtn').click(function () {
        $(".trades-side").hide();
        $(".trades-body").css("width", "95%");
    });
    
    $('#accountFilterId').click(function () {
        $(".trades-side").show();
        $(".trades-body").css("width", "79%");
    });
  </script>

{% endblock content %}
